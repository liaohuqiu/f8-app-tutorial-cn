<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<meta property="og:url" content="http://f8-app-tutorial-cn.liaohuqiu.net/tutorials/building-the-f8-app/design/" />
	<meta property="og:site_name" content="Facebook React Native 教程"/>
	<meta property="og:title" content="Facebook React Native 教程" />
	<meta property="og:image" content="http://f8-app-tutorial-cn.liaohuqiu.net/static/og_image.png" />
	<meta property="og:description" content="我们将谈谈为什么 React Native 可以针对，或者甚至是应该针对，各个平台量身定制。而非各个平台上没有任何区分。" />
  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css">
  <link rel="stylesheet" type="text/css" media="screen" href="//cdn.jsdelivr.net/font-hack/2.019/css/hack.min.css">

  <link rel="icon" href="static/favicon_junction.png" type="image/x-icon">

  <base href="/" />

  <script src="https://fb.me/react-with-addons-0.13.1.min.js"></script>

  <title>应用的多平台设计 &mdash; Facebook React Native 教程</title>
  <meta name="description" content="  这一系列的教程写于 F8 2016 app 开发期间，为的是用简单的文字来介绍 React Native 及其开源生态。教程于 2016 年 4 月 13 号发布到 makeitopen.com，内容翔实很有指导意义，我 看了之后花了周六日两天时间，翻译成中文，方便大家学习。">

  <link rel="canonical" href="http://f8-app-tutorial-cn.liaohuqiu.net/tutorials/building-the-f8-app/design/">
  <link rel="alternate" type="application/rss+xml" title="Facebook React Native 教程" href="http://f8-app-tutorial-cn.liaohuqiu.net/feed/" />
</head>

  <body>
    <div id="fixed_header" class="fixedHeaderContainer visible">
  <header>
    <a href="/">
      <img src="/static/logo_square_small.png">
      <h2>构建 Facebook F8 2016 App / React Native 开发指南</h2>
    </a>

    <div class="navigationWrapper navigationFull" id="flat_nav">
      <nav class="navigation">
        <ul>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

    <div class="navPusher">
      
<div class="mainContainer blogContainer postContainer">
  <div id="main_wrap" class="wrapper mainWrapper">
    
<div class="post">
  <header class="post-header">
    <h2 class="postSubtitle">
      <span>构建 F8 2016 App: 第二章</span>
      应用的多平台设计
    </h2>
    <div class="postPlugins">
      <div class="pluginBlock">
        <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="应用的多平台设计">Tweet</a>
      </div>
      <div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div>
    </div>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    <script>
      window.fbAsyncInit = function() {
      FB.init({
        appId      : '',
        xfbml      : true,
        version    : 'v2.3'
      });
      };

      (function(d, s, id){
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>
  </header>

  <article class="post-content">
   
      <blockquote>
  <p><em>这一系列的教程写于 F8 2016 app 开发期间，为的是用简单的文字来介绍 React Native 及其开源生态。教程于 2016 年 4 月 13 号发布到 makeitopen.com，内容翔实很有指导意义，<a href="https://github.com/liaohuqiu">我</a> 看了之后花了周六日两天时间，翻译成中文，方便大家学习。</em></p>
</blockquote>

<p>React Native 的一个亮点就是，他可以简单地创建可同时在 iOS 和 Android 平台上运行的应用，不必用这两个平台的原生语言重复大部分的业务逻辑。</p>

<p>尽管如此，React Native 的哲学其实是：“一次学习，随处可写”，而非：“一次编码，随处可运行”。这两者的细微差别在于，React Native 的 app 应该对各个平台做适配，而非让他们变得一样。</p>

<p>从 UI 的角度来看，各个平台有不同的视觉样式，UI 规范，或者从技术实现能力来看，应该从公共的 UI 基础入手，然后对两个平台做适配。</p>

<h4 id="section">开始之前</h4>

<p>从这一章节开始，我们将会涉及到这个 app 的代码，所以你应该 <a href="https://github.com/fbsamples/f8app">看看源码</a> 或者把源码 clone 到本地。 你也可以根据 <a href="tutorials/building-the-f8-app/local-setup/">设置和运行 App 章节</a> 的内容在本地运行 App。不过这个章节中，你只需要看看源码即可。</p>

<h3 id="react-native-">React Native 的思想</h3>

<p>在你写任何 React Native 的代码之前，React Native 有一个非常重要的概念指导你如何看待 app 的每一个部分。那就是：“尽可能地复用代码”。</p>

<p>这也许看起来和 React Native 为各个平台做视觉适配冲突。视觉适配似乎是尝试为 iOS 和 Android 创建单独的组件。</p>

<p>其实不是的，这只要求用 React Native 写代码时，尽可能地共享代码。</p>

<p>当我们考量 React Native app 中的可视化组件时，关键在于使用平台抽象。工程师和设计师确定 app 中可复用的组件，比如：按钮，容器，列表的每一行，等等。并且，只在有需要的地方将这些组件做分化。</p>

<p>当然，有许多组件是比较复杂的，我们看看 F8 app 中的不同的组件。</p>

<h3 id="section-1">多样化更小的组件</h3>

<p>这是 F8 app 中的一个例子：</p>

<p><img src="/static/images/iOS vs Android Segmented Controls@3x.png" alt="iOS and Android Segmented Controls Comparison" /></p>

<p>在 iOS 中，tab 控件是圆角；而在 Android 上，应该是下划线风格。在这两个平台上，控件的功能是一样的。</p>

<p>在视觉上，他们有一点不同。再次强调一下，我们需要“尽可能地复用代码”。</p>

<p>对于这样一个小组件来说，我们有大量的跨平台的逻辑是重合的：都是显示文本的按钮，都有 active，hover 状态，他们之间唯一的差别就在于视觉样式上的轻微的差别。所以最好的方式是使用同一个组件，然后在必要的地方，用控制语句来区别。</p>

<p>这个是以上控件的示例代码（来自于 <code class="highlighter-rouge">&lt;F8SegmentedControl&gt;</code>）：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></td><td class="code"><pre><span class="cm">/* from js/common/F8SegmentedControl.js */</span>
<span class="kr">class</span> <span class="nx">Segment</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nl">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">value</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
    <span class="nl">isSelected</span><span class="p">:</span> <span class="kr">boolean</span><span class="p">;</span>
    <span class="nl">selectionColor</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
    <span class="nl">onPress</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">};</span>

<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">selectedButtonStyle</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">isSelected</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">selectedButtonStyle</span> <span class="o">=</span> <span class="p">{</span> <span class="na">borderColor</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">selectionColor</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">deselectedLabelStyle</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">isSelected</span> <span class="o">&amp;&amp;</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="s1">'android'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">deselectedLabelStyle</span> <span class="o">=</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">deselectedLabel</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">accessibilityTraits</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'button'</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">isSelected</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">accessibilityTraits</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">'selected'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">TouchableOpacity</span>
        <span class="nx">accessibilityTraits</span><span class="o">=</span><span class="p">{</span><span class="nx">accessibilityTraits</span><span class="p">}</span>
        <span class="nx">activeOpacity</span><span class="o">=</span><span class="p">{</span><span class="mf">0.8</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onPress</span><span class="p">}</span>
        <span class="nx">style</span><span class="o">=</span><span class="p">{[</span><span class="nx">styles</span><span class="p">.</span><span class="nx">button</span><span class="p">,</span> <span class="nx">selectedButtonStyle</span><span class="p">]}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{[</span><span class="nx">styles</span><span class="p">.</span><span class="nx">label</span><span class="p">,</span> <span class="nx">deselectedLabelStyle</span><span class="p">]}</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">title</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/TouchableOpacity</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Here we’re simply applying different styles depending on which platform the code runs</p>

<p>在这里，我们使用 React Native 的 <a href="https://facebook.github.io/react-native/docs/platform-specific-code.html#platform-module">Platform module</a>，根据代码在不同的平台上运行，应用不同的样式。在这两个平台上，tab 按钮先使用同样的样式，然后分化（代码来自 <code class="highlighter-rouge">&lt;F8SegmentedControl&gt;</code>）：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></td><td class="code"><pre><span class="cm">/* from js/common/F8SegmentedControl.js */</span>
<span class="kd">var</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">F8StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">container</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flexDirection</span><span class="p">:</span> <span class="s1">'row'</span><span class="p">,</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="s1">'transparent'</span><span class="p">,</span>
    <span class="na">ios</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">paddingBottom</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
      <span class="na">justifyContent</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
      <span class="na">alignItems</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">android</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">paddingLeft</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="na">button</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">borderColor</span><span class="p">:</span> <span class="s1">'transparent'</span><span class="p">,</span>
    <span class="na">alignItems</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
    <span class="na">justifyContent</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="s1">'transparent'</span><span class="p">,</span>
    <span class="na">ios</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">height</span><span class="p">:</span> <span class="nx">HEIGHT</span><span class="p">,</span>
      <span class="na">paddingHorizontal</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="na">borderRadius</span><span class="p">:</span> <span class="nx">HEIGHT</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
      <span class="na">borderWidth</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">android</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">paddingBottom</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
      <span class="na">paddingHorizontal</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="na">borderBottomWidth</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="na">marginRight</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="na">label</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">letterSpacing</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">fontSize</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="na">color</span><span class="p">:</span> <span class="s1">'white'</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">deselectedLabel</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">color</span><span class="p">:</span> <span class="s1">'rgba(255, 255, 255, 0.7)'</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>这里，我们使用一个改造后的 <a href="https://facebook.github.io/react-native/docs/stylesheet.html">React Native <code class="highlighter-rouge">StyleSheet</code> API</a>，可根据平台进行一下选择转换：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="kr">export</span> <span class="kd">function</span> <span class="nx">create</span><span class="p">(</span><span class="nx">styles</span><span class="err">:</span> <span class="nb">Object</span><span class="p">)</span><span class="err">:</span> <span class="p">{[</span><span class="nx">name</span><span class="err">:</span> <span class="nx">string</span><span class="p">]</span><span class="err">:</span> <span class="nx">number</span><span class="p">}</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">platformStyles</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">styles</span><span class="p">).</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">name</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="p">{</span><span class="nx">ios</span><span class="p">,</span> <span class="nx">android</span><span class="p">,</span> <span class="p">...</span><span class="nx">style</span><span class="p">}</span> <span class="o">=</span> <span class="p">{...</span><span class="nx">styles</span><span class="p">[</span><span class="nx">name</span><span class="p">]};</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ios</span> <span class="o">&amp;&amp;</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="s1">'ios'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">style</span> <span class="o">=</span> <span class="p">{...</span><span class="nx">style</span><span class="p">,</span> <span class="p">...</span><span class="nx">ios</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">android</span> <span class="o">&amp;&amp;</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="s1">'android'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">style</span> <span class="o">=</span> <span class="p">{...</span><span class="nx">style</span><span class="p">,</span> <span class="p">...</span><span class="nx">android</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">platformStyles</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">style</span><span class="p">;</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">platformStyles</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>在这 <code class="highlighter-rouge">F8StyleSheet</code> 函数中，我们解析一个给定的样式对象。如果我们遇有 ios 或者 android 这样的 key 并和当前运行的平台一致，我们就使用 key 对应的样式，否则忽略。这个例子也向我们说明了，React Native 中尽量复用代码以减少重复代码的思想。</p>

<p>现在，我们可以在 app 中复用这个组件了，并且，UI 样式是对 iOS 和 Android 适配的。</p>

<h3 id="section-2">分离复杂的差异</h3>

<p>当在两个平台实现一个不仅在 UI 上分化，同时也几乎没有共同业务逻辑的组件时，我们需要采用不同的方式。下面的例子是 app 中的顶级导航菜单：</p>

<p><img src="/static/images/iOS vs. Android@3x.png" alt="iOS and Android Main Navigation Comparison" /></p>

<p>我们可以看到， iOS 版本使用固定的底部导航，而 Android 则使用侧滑菜单。他们之间在动画，样式，甚至菜单内容本身都存在巨大的差异。比如在 Android 上，有类似 logout 这样的菜单选项。</p>

<p>当然，你 <em>可以</em> 继续使用一个组件去实现，但是这个组件的逻辑会充斥着大量的条件控制语句，很快就会变得难以理解和维护。</p>

<p>正确的做法，我们应该使用 React Native 内置的 <a href="http://facebook.github.io/react-native/docs/platform-specific-code.html#platform-specific-extensions">特定平台下的扩展</a>。这个特性允许我们创建两个不同的组件，其中一个叫 <code class="highlighter-rouge">FBTabsView.ios.js</code>，另外一个叫 <code class="highlighter-rouge">FBTabsView.android.js</code>。React Native 会根据运行的平台自动找到并加载他们。</p>

<h4 id="ui-">内置的 UI 组件</h4>

<p>在每个 <code class="highlighter-rouge">FBTabsView</code> 组件中，我们也可以复用一些内置的 UI 元素。在 Android 版本上使用 <a href="http://facebook.github.io/react-native/docs/drawerlayoutandroid.html"><code class="highlighter-rouge">DrawerLayoutAndroid</code></a> （根据名字我们也可以知道，这个组件只在 Android 中才有）：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="cm">/* from js/tabs/F8TabsView.android.js */</span>
<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">DrawerLayoutAndroid</span>
      <span class="nx">ref</span><span class="o">=</span><span class="s2">"drawer"</span>
      <span class="nx">drawerWidth</span><span class="o">=</span><span class="p">{</span><span class="mi">300</span><span class="p">}</span>
      <span class="nx">drawerPosition</span><span class="o">=</span><span class="p">{</span><span class="nx">DrawerLayoutAndroid</span><span class="p">.</span><span class="nx">positions</span><span class="p">.</span><span class="nx">Left</span><span class="p">}</span>
      <span class="nx">renderNavigationView</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderNavigationView</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderContent</span><span class="p">()}</span>
      <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/DrawerLayoutAndroid</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>在第 8 行，我们指定绘制菜单内容的函数 <code class="highlighter-rouge">renderNavigationViewb()</code>，在这个函数里面，我们绘制一个 <a href="http://facebook.github.io/react-native/docs/scrollview.html"><code class="highlighter-rouge">ScrollView</code></a> 组件，在这个组件内，我们填充了很多 <code class="highlighter-rouge">MenuItem</code>（参见 <a href="https://github.com/fbsamples/f8app/blob/master/js/tabs/MenuItem.js"><code class="highlighter-rouge">MenuItem.js</code></a>）：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></td><td class="code"><pre><span class="cm">/* from js/tabs/F8TabsView.android.js */</span>
<span class="nx">renderNavigationView</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="k">return</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">ScrollView</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">drawer</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">MenuItem</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Schedule"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'schedule'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'schedule'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">scheduleIcon</span><span class="p">}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">scheduleIconSelected</span><span class="p">}</span>
      <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">MenuItem</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"My F8"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'my-schedule'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'my-schedule'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/my-schedule-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/my-schedule-icon-active.png'</span><span class="p">)}</span>
      <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">MenuItem</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Map"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'map'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'map'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./maps/img/maps-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./maps/img/maps-icon-active.png'</span><span class="p">)}</span>
      <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">MenuItem</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Notifications"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'notifications'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'notifications'</span><span class="p">)}</span>
        <span class="nx">badge</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">notificationsBadge</span><span class="p">}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./notifications/img/notifications-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./notifications/img/notifications-icon-active.png'</span><span class="p">)}</span>
      <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">MenuItem</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Info"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'info'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'info'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./info/img/info-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./info/img/info-icon-active.png'</span><span class="p">)}</span>
      <span class="sr">/</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/ScrollView</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>对比来看，iOS 版本在 <code class="highlighter-rouge">render()</code> 函数中使用了另外一个不同的内置组件，<a href="http://facebook.github.io/react-native/docs/tabbarios.html"><code class="highlighter-rouge">TabBarIOS</code></a>：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></td><td class="code"><pre><span class="cm">/* from js/tabs/F8TabsView.ios.js */</span>
<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">scheduleIcon</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">day</span> <span class="o">===</span> <span class="mi">1</span>
    <span class="p">?</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/schedule-icon-1.png'</span><span class="p">)</span>
    <span class="p">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/schedule-icon-2.png'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">scheduleIconSelected</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">day</span> <span class="o">===</span> <span class="mi">1</span>
    <span class="p">?</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/schedule-icon-1-active.png'</span><span class="p">)</span>
    <span class="p">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/schedule-icon-2-active.png'</span><span class="p">);</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">TabBarIOS</span> <span class="nx">tintColor</span><span class="o">=</span><span class="p">{</span><span class="nx">F8Colors</span><span class="p">.</span><span class="nx">darkText</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">TabBarItemIOS</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Schedule"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'schedule'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'schedule'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">scheduleIcon</span><span class="p">}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">scheduleIconSelected</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">GeneralScheduleView</span>
          <span class="nx">navigator</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">navigator</span><span class="p">}</span>
          <span class="nx">onDayChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleDayChange</span><span class="p">}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/TabBarItemIOS</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">TabBarItemIOS</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"My F8"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'my-schedule'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'my-schedule'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/my-schedule-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./schedule/img/my-schedule-icon-active.png'</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">MyScheduleView</span>
          <span class="nx">navigator</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">navigator</span><span class="p">}</span>
          <span class="nx">onJumpToSchedule</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">(</span><span class="s1">'schedule'</span><span class="p">)}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/TabBarItemIOS</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">TabBarItemIOS</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Map"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'map'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'map'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./maps/img/maps-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./maps/img/maps-icon-active.png'</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">F8MapView</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="sr">/TabBarItemIOS</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">TabBarItemIOS</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Notifications"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'notifications'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'notifications'</span><span class="p">)}</span>
        <span class="nx">badge</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">notificationsBadge</span><span class="p">}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./notifications/img/notifications-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./notifications/img/notifications-icon-active.png'</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">F8NotificationsView</span> <span class="nx">navigator</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">navigator</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/TabBarItemIOS</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">TabBarItemIOS</span>
        <span class="nx">title</span><span class="o">=</span><span class="s2">"Info"</span>
        <span class="nx">selected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span> <span class="o">===</span> <span class="s1">'info'</span><span class="p">}</span>
        <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onTabSelect</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'info'</span><span class="p">)}</span>
        <span class="nx">icon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./info/img/info-icon.png'</span><span class="p">)}</span>
        <span class="nx">selectedIcon</span><span class="o">=</span><span class="p">{</span><span class="nx">require</span><span class="p">(</span><span class="s1">'./info/img/info-icon-active.png'</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">F8InfoView</span> <span class="nx">navigator</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">navigator</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/TabBarItemIOS</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/TabBarIOS</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>我们可以看到，虽然 iOS 的菜单用了近乎一样的数据，只有细微的数据结构的差别。和 Android 中有一个单独的函数创建菜单项不一样，菜单项 <a href="http://facebook.github.io/react-native/docs/tabbarios-item.html#content"><code class="highlighter-rouge">TabBarItemIOS</code></a> 被当作子组件插入到的父容器菜单中。</p>

<p>这些 <code class="highlighter-rouge">TabBarItem</code> 大体上相当于 Android 的 <code class="highlighter-rouge">MenuItem</code> 组件。区别只在于，在 Android 的组件中，我们定义了一个 <a href="http://facebook.github.io/react-native/docs/view.html#content"><code class="highlighter-rouge">View</code> component</a>:</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">activeTab</span><span class="p">}</span><span class="o">&gt;</span>
  <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderContent</span><span class="p">()}</span>
<span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span></pre></td></tr></tbody></table>
</div>
</div>
<p>当 tab 改变时，使用 <code class="highlighter-rouge">renderContent()</code> 改变内容。而 iOS 的组件却有多个不同的 <code class="highlighter-rouge">View</code> 组件，比如：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="nx">GeneralScheduleView</span>
  <span class="nx">navigator</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">navigator</span><span class="p">}</span>
  <span class="nx">onDayChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleDayChange</span><span class="p">}</span>
<span class="sr">/</span><span class="err">&gt;
</span></pre></td></tr></tbody></table>
</div>
</div>

<p>他们属于 <code class="highlighter-rouge">TabBarItem</code> 的一部分，点击之后，这部分会显示。</p>

<h3 id="the-design-iteration-cycle">设计迭代周期</h3>

<p>不管你在开发什么应用，快速调整 UI 总是非常痛苦的。如果工程师和设计师坐在一起调，整个处理过程会慢下来。</p>

<p>React Native 有一个 <a href="http://facebook.github.io/react-native/docs/debugging.html#live-reload">live reload</a> 特性。这个特性使得 JavaScript 代码发生改变之后，界面会立刻自动刷新。这个特性可缩短设计迭代流程。</p>

<p>但如果一个组件在不同状态下表现得不一样时该怎么办？比如，有一个按钮，有默认样式，按下状态时的样式，正在加载时，加载完成时的状态。</p>

<p>为了避免每一次都在 app 中和控件交互，我们做了一个可视的调试控件 <code class="highlighter-rouge">Playground</code>：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre><span class="cm">/* from js/setup.js */</span>
<span class="kr">class</span> <span class="nx">Playground</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kr">const</span> <span class="nx">define</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span><span class="err">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">render</span><span class="err">:</span> <span class="nb">Function</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Example</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span> <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="nx">render</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="se">)</span><span class="err">;
</span>    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">AddToScheduleButton</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./tabs/schedule/AddToScheduleButton'</span><span class="p">);</span>
    <span class="nx">AddToScheduleButton</span><span class="p">.</span><span class="nx">__cards__</span><span class="p">(</span><span class="nx">define</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="nx">content</span><span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=&gt;</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<!---
TOWATCH: Changes to the Playground component
-->

<p>这个控件简单地创建了一个空的 view，这个 view 可以被真正的控件置换。比如当我们在一个 UI 组件中，把这个和一些定义绑定，以 <code class="highlighter-rouge">AddToScheduleButton</code> 为例说明：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre><span class="cm">/* from js/tabs/schedule/AddToScheduleButton.js */</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">__cards__</span> <span class="o">=</span> <span class="p">(</span><span class="nx">define</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">f</span><span class="p">;</span>
  <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">f</span> <span class="o">&amp;&amp;</span> <span class="nx">f</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">);</span>

  <span class="nx">define</span><span class="p">(</span><span class="s1">'Inactive'</span><span class="p">,</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">update</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="o">&lt;</span><span class="nx">AddToScheduleButton</span> <span class="nx">isAdded</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">update</span><span class="p">(</span><span class="o">!</span><span class="nx">state</span><span class="p">)}</span> <span class="sr">/&gt;</span><span class="se">)</span><span class="err">;
</span>
  <span class="nx">define</span><span class="p">(</span><span class="s1">'Active'</span><span class="p">,</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">update</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="o">&lt;</span><span class="nx">AddToScheduleButton</span> <span class="nx">isAdded</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">update</span><span class="p">(</span><span class="o">!</span><span class="nx">state</span><span class="p">)}</span> <span class="sr">/&gt;</span><span class="se">)</span><span class="err">;
</span>
  <span class="nx">define</span><span class="p">(</span><span class="s1">'Animated'</span><span class="p">,</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">update</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">f</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">update</span><span class="p">(</span><span class="o">!</span><span class="nx">state</span><span class="p">);</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">AddToScheduleButton</span> <span class="nx">isAdded</span><span class="o">=</span><span class="p">{</span><span class="nx">state</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span>  <span class="p">});</span>
<span class="p">};</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>在 UI 预览工具中我们可以看到：</p>

<p><img src="/static/images/button-playground.gif" alt="UI preview playground in action with a button and three different states" /></p>

<p>这个例子定义了按钮正常态和按压态。为了预览过渡动画，还定义了在两个状态间循环往复的动画状态。</p>

<p>这让工程师和设计师在一起调整基础组件的视觉风格时变得相当快。</p>

<p><code class="highlighter-rouge">&lt;Playground&gt;</code> 可以在任何 React Native app 中复用，如果你想使用它，只需要在 <code class="highlighter-rouge">setup()</code> 函数中加载 <code class="highlighter-rouge">&lt;Playground&gt;</code> 即可：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="cm">/* from js/setup.js */</span>
<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">F8App</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/Provider</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>变为：</p>

<div class="highlighter-rouge"><div class="rougeHighlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="cm">/* in js/setup.js */</span>
<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">Playground</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/Provider</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>可以修改 <code class="highlighter-rouge">&lt;Playground&gt;</code> 组件以加载其他不同的组件。</p>

    
  </article>
  








<div class="postPagination">

<div class="pagingLink previousLink">
  <a href="/tutorials/building-the-f8-app/planning/">
    <i>&lsaquo;</i>
    <span>App 的筹备</span>
  </a>
</div>



<div class="pagingLink nextLink">
  <a href="/tutorials/building-the-f8-app/data/">
    <span>数据集成</span>
    <i>&rsaquo;</i>
  </a>
</div>

</div>




</div>

    <div>
</div>
<nav class='toc' id="doc_nav"></nav>
<script>
  
  var docnavData = [
    {
      group     : "构建 F8 2016 App",
      items     : [
        
        
        {
          key : "/tutorials/building-the-f8-app/planning/",
          title : "App 的筹备",
          type: "",
          partlabel : "第一章",
          url : "/tutorials/building-the-f8-app/planning/",
        },
        
        
        {
          key : "/tutorials/building-the-f8-app/design/",
          title : "应用的多平台设计",
          type: "",
          partlabel : "第二章",
          url : "/tutorials/building-the-f8-app/design/",
        },
        
        
        {
          key : "/tutorials/building-the-f8-app/data/",
          title : "数据集成",
          type: "",
          partlabel : "第三章",
          url : "/tutorials/building-the-f8-app/data/",
        },
        
        
        {
          key : "/tutorials/building-the-f8-app/testing/",
          title : "测试",
          type: "",
          partlabel : "第四章",
          url : "/tutorials/building-the-f8-app/testing/",
        },
        
        
        {
          key : "/tutorials/building-the-f8-app/local-setup/",
          title : "本地设置运行 App",
          type: "appendix",
          partlabel : "附录 1",
          url : "/tutorials/building-the-f8-app/local-setup/",
        },
        
        
        {
          key : "/tutorials/building-the-f8-app/relay/",
          title : "使用 Relay 和 GraphQL",
          type: "appendix",
          partlabel : "附录 2",
          url : "/tutorials/building-the-f8-app/relay/",
        },
        
        
        {
          key : "/tutorials/building-the-f8-app/windows/",
          title : "移植 F8 App 到 Windows",
          type: "appendix",
          partlabel : "附录 3",
          url : "/tutorials/building-the-f8-app/windows/",
        }
        
      ],
    },
  ];
</script>
<script type="text/javascript">
  var DocNav = React.createClass({displayName: "DocNav",
    getInitialState: function() {
      return {
        toggleActive: false,
      };
    },
    getDefaultProps: function() {
      return {
        currentDoc: "应用的多平台设计",
        currentGroup: "构建 F8 2016 App",
        data: docnavData,
      }
    },
    handleSlide: function(id) {
      this.setState({
        toggleActive: !this.state.toggleActive,
      });
    },
    render: function() {
      var classes = React.addons.classSet({
        'navToggle': true,
        'navToggleActive': this.state.toggleActive,
      });
      var navClasses = React.addons.classSet({
        'toggleNav': true,
        'toggleNavActive': this.state.toggleActive,
      });
      return (
        React.createElement("div", {className: navClasses},
          React.createElement("section", null,
            this.props.data.map(this.renderNavGroups)
          ),
          React.createElement("div", {className: classes, onClick: this.handleSlide},
            React.createElement("span", null, "目录"), React.createElement("i", null, String.fromCharCode(43))
          )
        )
      );
    },
    renderNavGroups: function(child, index) {
      var classes = React.addons.classSet({
        'navGroup': true,
        'navGroupActive': this.props.currentGroup === child.group,
      });
      return (
        React.createElement("div", {className: classes, key: index},
          React.createElement("h3", null, "目录"),
          React.createElement("ul", null,
            child.items.map(this.renderNavItems)
          )
        )
      );
    },
    renderNavItems: function(child, index) {
      var itemClasses = React.addons.classSet({
        'navListItem': true,
        'navListItemActive': this.props.currentDoc === child.title,
        'navListItemAppendix': child.type === 'appendix',
      });
      var classes = React.addons.classSet({
        'navItem': true,
        'navItemActive': this.props.currentDoc === child.title,
      });
      return (
        React.createElement("li", {className: itemClasses, key: index}, React.createElement("a", {className: classes, href: child.url},  child.partlabel +': '+ child.title))
      );
    },
  });

  function docNavRender(docnavData) {
    React.render(
      React.createElement(DocNav, {data: docnavData}),
      document.getElementById('doc_nav')
    );
  }
  docNavRender(docnavData);
</script>

  </div>
</div>


      <div class="footerContainer">
  <div id="footer_wrap" class="wrapper footerWrapper">
    <div class="footerBlocks">
      <div id="fb_oss" class="footerSection fbOpenSourceFooter">
          <svg class="facebookOSSLogoSvg" viewBox="0 0 1133.9 1133.9" x="0px" y="0px">
            <g>
              <path class="logoRing outerRing" d="M 498.3 3.7 c 153.6 88.9 307.3 177.7 461.1 266.2 c 7.6 4.4 10.3 9.1 10.3 17.8 c -0.3 179.1 -0.2 358.3 0 537.4 c 0 8.1 -2.4 12.8 -9.7 17.1 c -154.5 88.9 -308.8 178.1 -462.9 267.5 c -9 5.2 -15.5 5.3 -24.6 0.1 c -153.9 -89.2 -307.9 -178 -462.1 -266.8 C 3 838.8 0 833.9 0 825.1 c 0.3 -179.1 0.2 -358.3 0 -537.4 c 0 -8.6 2.6 -13.6 10.2 -18 C 164.4 180.9 318.4 92 472.4 3 C 477 -1.5 494.3 -0.7 498.3 3.7 Z M 48.8 555.3 c 0 79.9 0.2 159.9 -0.2 239.8 c -0.1 10 3 15.6 11.7 20.6 c 137.2 78.8 274.2 157.8 411 237.3 c 9.9 5.7 17 5.7 26.8 0.1 c 137.5 -79.8 275.2 -159.2 412.9 -238.5 c 7.4 -4.3 10.5 -8.9 10.5 -17.8 c -0.3 -160.2 -0.3 -320.5 0 -480.7 c 0 -8.8 -2.8 -13.6 -10.3 -18 C 772.1 218 633.1 137.8 494.2 57.4 c -6.5 -3.8 -11.5 -4.5 -18.5 -0.5 C 336.8 137.4 197.9 217.7 58.8 297.7 c -7.7 4.4 -10.2 9.2 -10.2 17.9 C 48.9 395.5 48.8 475.4 48.8 555.3 Z" />
              <path class="logoRing middleRing" d="M 184.4 555.9 c 0 -33.3 -1 -66.7 0.3 -100 c 1.9 -48 24.1 -86 64.7 -110.9 c 54.8 -33.6 110.7 -65.5 167 -96.6 c 45.7 -25.2 92.9 -24.7 138.6 1 c 54.4 30.6 108.7 61.5 162.2 93.7 c 44 26.5 67.3 66.8 68 118.4 c 0.9 63.2 0.9 126.5 0 189.7 c -0.7 50.6 -23.4 90.7 -66.6 116.9 c -55 33.4 -110.8 65.4 -167.1 96.5 c -43.4 24 -89 24.2 -132.3 0.5 c -57.5 -31.3 -114.2 -64 -170 -98.3 c -41 -25.1 -62.9 -63.7 -64.5 -112.2 C 183.5 621.9 184.3 588.9 184.4 555.9 Z M 232.9 556.3 c 0 29.5 0.5 59.1 -0.1 88.6 c -0.8 39.2 16.9 67.1 50.2 86.2 c 51.2 29.4 102.2 59.2 153.4 88.4 c 31.4 17.9 63.6 18.3 95 0.6 c 53.7 -30.3 107.1 -61.2 160.3 -92.5 c 29.7 -17.5 45 -44.5 45.3 -78.8 c 0.6 -61.7 0.5 -123.5 0 -185.2 c -0.3 -34.4 -15.3 -61.5 -44.9 -79 C 637.7 352.6 583 320.8 527.9 290 c -27.5 -15.4 -57.2 -16.1 -84.7 -0.7 c -56.9 31.6 -113.4 64 -169.1 97.6 c -26.4 15.9 -40.7 41.3 -41.1 72.9 C 232.6 491.9 232.9 524.1 232.9 556.3 Z" />
              <path class="logoRing innerRing" d="M 484.9 424.4 c 69.8 -2.8 133.2 57.8 132.6 132 C 617 630 558.5 688.7 484.9 689.1 c -75.1 0.4 -132.6 -63.6 -132.7 -132.7 C 352.1 485 413.4 421.5 484.9 424.4 Z M 401.3 556.7 c -3.4 37.2 30.5 83.6 83 84.1 c 46.6 0.4 84.8 -37.6 84.9 -84 c 0.1 -46.6 -37.2 -84.4 -84.2 -84.6 C 432.2 472.1 397.9 518.3 401.3 556.7 Z" />
            </g>
          </svg>
        <h2><a class="footerLink" href="https://code.facebook.com/projects/" target="_blank">Facebook Open Source</a></h2>
      </div>
      <div class="footerSection rightAlign">
        <a class="footerLink" href="https://github.com/liaohuqiu/f8-app-tutorial-cn" target="_blank">本文档 GitHub 项目</a>
      </div>
    </div>
  </div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43024238-14', 'auto');
  ga('send', 'pageview');

</script>


    </div>
  </body>

</html>
